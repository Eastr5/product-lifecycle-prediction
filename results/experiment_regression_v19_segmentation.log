2025-06-08 07:38:20,377 - root - INFO - 日志同时输出到文件: /home/featurize/work/product_lifecycle_predictor_vA/results/experiment_regression_v19_segmentation.log 和控制台。
2025-06-08 07:38:20,377 - root - INFO - 项目 'Product Trend Prediction (Continuous Metrics)' 版本 '1.19.0-product_segmentation' 开始运行。
2025-06-08 07:38:20,377 - root - INFO - ===== Phase 1: 数据加载和预处理 =====
2025-06-08 07:38:20,377 - root - INFO - 开始加载和预处理M5数据（包含层级和细化事件特征）...
2025-06-08 07:38:20,378 - root - INFO - 从缓存加载已处理的周度数据: data/processed/m5_weekly_processed_mha_detailed_event.parquet
2025-06-08 07:38:20,602 - root - INFO - 从缓存加载数据成功。
2025-06-08 07:38:20,603 - root - INFO - Phase 1: 数据加载和预处理成功，返回 587569 行数据。
2025-06-08 07:38:20,603 - root - INFO - ===== Phase 2: 特征工程 =====
2025-06-08 07:38:20,603 - root - INFO - 开始生成特征和目标变量 (包含产品分段特征)...
2025-06-08 07:38:20,871 - root - INFO - 已准备/计算源指标 (用于衍生特征): sales_W
2025-06-08 07:38:20,873 - root - INFO - 已准备/计算源指标 (用于衍生特征): price_W_mean
2025-06-08 07:38:21,572 - root - INFO - 已准备/计算源指标 (用于衍生特征): smoothed_sales_W
2025-06-08 07:38:22,453 - root - INFO - 已准备/计算源指标 (用于衍生特征): sales_W_volatility_4w
2025-06-08 07:38:26,148 - root - INFO - 已准备/计算源指标 (用于衍生特征): sales_W_growth_4w_1p
2025-06-08 07:38:29,679 - root - INFO - 已准备/计算源指标 (用于衍生特征): smoothed_sales_W_growth_4w_1p
2025-06-08 07:38:29,694 - root - INFO - 已计算相对层级特征: item_div_dept_sales_W
2025-06-08 07:38:29,709 - root - INFO - 已计算相对层级特征: item_div_store_sales_W
2025-06-08 07:38:29,709 - root - INFO - 将为以下成功计算/获取并配置的源指标生成滞后和滚动特征: ['sales_W', 'price_W_mean', 'smoothed_sales_W', 'sales_W_volatility_4w', 'sales_W_growth_4w_1p', 'smoothed_sales_W_growth_4w_1p', 'item_div_dept_sales_W', 'item_div_store_sales_W']
2025-06-08 07:38:49,678 - root - INFO - 开始创建产品分段特征...
2025-06-08 07:38:51,219 - root - INFO - 销量分段完成。各段分布:
sales_segment
HighSales    199381
LowSales     194466
MidSales     193722
Name: count, dtype: int64
2025-06-08 07:38:51,245 - root - INFO - 波动性分段完成。各段分布:
volatility_segment
Stable      293786
Volatile    293783
Name: count, dtype: int64
2025-06-08 07:38:51,590 - root - INFO - 产品分段特征 'product_segment' 创建完成。
2025-06-08 07:38:52,093 - root - INFO - 时间相关特征创建完成。
2025-06-08 07:38:52,093 - root - INFO - 开始创建事件交互特征...
2025-06-08 07:38:52,097 - root - INFO - 已创建事件交互特征: event_any_X_sales_roll_mean_4w
2025-06-08 07:38:52,101 - root - INFO - 已创建事件交互特征: event_any_X_sales_volatility_4w
2025-06-08 07:38:52,104 - root - INFO - 已创建事件交互特征: snap_ca_X_sales_roll_mean_4w
2025-06-08 07:38:52,108 - root - INFO - 已创建事件交互特征: snap_ca_X_sales_volatility_4w
2025-06-08 07:38:52,336 - root - INFO - 目标变量列: ['sales_W_lead1', 'sales_W_lead2', 'sales_W_growth_4w_1p_lead1', 'sales_W_growth_4w_1p_lead2', 'smoothed_sales_W_growth_4w_1p_lead1', 'smoothed_sales_W_growth_4w_1p_lead2']
2025-06-08 07:38:52,716 - root - INFO - 因目标列中的NaN（来自未来期数shift）移除了 6584 行。
2025-06-08 07:38:53,990 - root - INFO - 特征工程完成。最终DataFrame形状: (580985, 104)
2025-06-08 07:38:53,990 - root - INFO - 实际最终输入特征列 (96): ['sales_W', 'smoothed_sales_W', 'price_W_mean', 'sales_W_growth_4w_1p', 'smoothed_sales_W_growth_4w_1p', 'sales_W_volatility_4w', 'item_div_dept_sales_W', 'item_div_store_sales_W', 'sales_W_lag_1', 'sales_W_lag_2']...
2025-06-08 07:38:53,990 - root - INFO - 实际最终目标列 (6): ['sales_W_lead1', 'sales_W_lead2', 'sales_W_growth_4w_1p_lead1', 'sales_W_growth_4w_1p_lead2', 'smoothed_sales_W_growth_4w_1p_lead1', 'smoothed_sales_W_growth_4w_1p_lead2']
2025-06-08 07:38:56,710 - root - INFO - Phase 2: 特征数据已保存到: data/features/m5_weekly_features_regression_v19_segmentation.parquet
2025-06-08 07:38:57,534 - root - INFO - 数据已划分为训练池 (539187行) 和最终测试集 (41798行) 基于日期 2016-01-03.
2025-06-08 07:38:57,534 - root - INFO - ===== Phase 3: 模型训练 (回归) =====
2025-06-08 07:38:57,534 - root - INFO - 开始回归模型训练流程...
2025-06-08 07:38:57,642 - root - INFO - 使用设备: cuda
2025-06-08 07:38:57,679 - root - INFO - 准备好的类别特征嵌入信息: {'item_id': {'vocab_size': 823, 'embedding_dim': 50}, 'store_id': {'vocab_size': 4, 'embedding_dim': 10}, 'product_segment': {'vocab_size': 6, 'embedding_dim': 5}}
2025-06-08 07:38:58,222 - root - INFO - 训练集 (用于统计和训练) 大小: 466956, 验证集大小: 72231
2025-06-08 07:39:00,601 - root - INFO - 为 3272 个序列计算了RMSSE缩放分母。
2025-06-08 07:39:00,601 - root - INFO - 为 3272 个序列计算了WRMSSE权重。
2025-06-08 07:39:00,839 - root - INFO - 拟合输入数值特征缩放器 (fit_transform)...
2025-06-08 07:39:02,294 - root - INFO - 拟合目标列缩放器 (fit_transform)...
2025-06-08 07:39:14,269 - root - INFO - 成功创建 431219 个时间序列样本。
2025-06-08 07:39:14,280 - root - INFO - 使用预训练的输入数值特征缩放器 (transform)...
2025-06-08 07:39:14,379 - root - INFO - 使用预训练的目标列缩放器 (transform)...
2025-06-08 07:39:21,353 - root - INFO - 成功创建 38102 个时间序列样本。
2025-06-08 07:39:21,353 - root - INFO - 训练集 DataLoader 创建完成。训练样本数: 431219
2025-06-08 07:39:21,354 - root - INFO - 验证集 DataLoader 创建完成。验证样本数: 38102
2025-06-08 07:39:21,354 - root - INFO - 构建 LSTMRegressor 模型: 数值特征数=93, 类别嵌入信息=True, 输出目标数=6, 使用注意力=True, 注意力类型='multihead', 注意力头数=4
2025-06-08 07:39:21,356 - root - INFO - 为 'item_id' 创建嵌入层: vocab_size=823, embedding_dim=50
2025-06-08 07:39:21,356 - root - INFO - 为 'store_id' 创建嵌入层: vocab_size=4, embedding_dim=10
2025-06-08 07:39:21,357 - root - INFO - 为 'product_segment' 创建嵌入层: vocab_size=6, embedding_dim=5
2025-06-08 07:39:21,357 - root - INFO - LSTM 输入维度: 158 (数值: 93, 嵌入: 65)
2025-06-08 07:39:21,362 - root - INFO - 创建 LSTM 层: hidden_size=64, num_layers=2, bidirectional=False
2025-06-08 07:39:21,362 - root - INFO - PyTorch MultiheadAttention 已启用: embed_dim=64, num_heads=4, dropout=0.1
2025-06-08 07:39:21,363 - root - INFO - 回归头添加全连接层: output_units=64
2025-06-08 07:39:21,363 - root - INFO - 回归头添加全连接层: output_units=32
2025-06-08 07:39:21,364 - root - INFO - 回归头最终输出层: output_units=6
2025-06-08 07:39:21,364 - root - INFO - LSTMRegressor 模型构建（可能带注意力机制）完成。
2025-06-08 07:39:22,028 - root - INFO - 使用损失函数: MSELoss, 优化器: Adam (lr=0.0005)
2025-06-08 07:39:22,028 - root - INFO - 开始训练模型，共 50 个 epochs...
2025-06-08 07:39:59,384 - root - INFO - Epoch [1/50] | Train Loss: 0.574415 | Val Loss: 0.393380 | LR: 0.0005000
2025-06-08 07:39:59,386 - root - INFO -   验证损失改善，保存最佳模型状态。Best Val Loss: 0.393380
2025-06-08 07:40:37,262 - root - INFO - Epoch [2/50] | Train Loss: 0.468167 | Val Loss: 0.326065 | LR: 0.0005000
2025-06-08 07:40:37,264 - root - INFO -   验证损失改善，保存最佳模型状态。Best Val Loss: 0.326065
2025-06-08 07:41:15,136 - root - INFO - Epoch [3/50] | Train Loss: 0.432834 | Val Loss: 0.311286 | LR: 0.0005000
2025-06-08 07:41:15,138 - root - INFO -   验证损失改善，保存最佳模型状态。Best Val Loss: 0.311286
2025-06-08 07:41:50,422 - root - INFO - Epoch [4/50] | Train Loss: 0.406488 | Val Loss: 0.364592 | LR: 0.0005000
2025-06-08 07:41:50,423 - root - INFO -   验证损失未改善 1轮。
2025-06-08 07:42:27,048 - root - INFO - Epoch [5/50] | Train Loss: 0.390456 | Val Loss: 0.301152 | LR: 0.0005000
2025-06-08 07:42:27,050 - root - INFO -   验证损失改善，保存最佳模型状态。Best Val Loss: 0.301152
2025-06-08 07:43:03,821 - root - INFO - Epoch [6/50] | Train Loss: 0.382460 | Val Loss: 0.334336 | LR: 0.0005000
2025-06-08 07:43:03,822 - root - INFO -   验证损失未改善 1轮。
2025-06-08 07:43:40,011 - root - INFO - Epoch [7/50] | Train Loss: 0.369686 | Val Loss: 0.442786 | LR: 0.0005000
2025-06-08 07:43:40,011 - root - INFO -   验证损失未改善 2轮。
2025-06-08 07:44:16,831 - root - INFO - Epoch [8/50] | Train Loss: 0.362124 | Val Loss: 0.363077 | LR: 0.0005000
2025-06-08 07:44:16,831 - root - INFO -   验证损失未改善 3轮。
2025-06-08 07:44:53,384 - root - INFO - Epoch [9/50] | Train Loss: 0.356989 | Val Loss: 0.441771 | LR: 0.0005000
2025-06-08 07:44:53,384 - root - INFO -   验证损失未改善 4轮。
2025-06-08 07:45:28,141 - root - INFO - Epoch [10/50] | Train Loss: 0.349826 | Val Loss: 0.422963 | LR: 0.0005000
2025-06-08 07:45:28,141 - root - INFO -   验证损失未改善 5轮。
2025-06-08 07:46:05,676 - root - INFO - Epoch [11/50] | Train Loss: 0.342412 | Val Loss: 0.306404 | LR: 0.0005000
2025-06-08 07:46:05,676 - root - INFO -   验证损失未改善 6轮。
2025-06-08 07:46:42,505 - root - INFO - Epoch [12/50] | Train Loss: 0.333007 | Val Loss: 0.365170 | LR: 0.0005000
2025-06-08 07:46:42,506 - root - INFO -   学习率从 0.0005000 降低到 0.0000500
2025-06-08 07:46:42,506 - root - INFO -   验证损失未改善 7轮。
2025-06-08 07:47:19,021 - root - INFO - Epoch [13/50] | Train Loss: 0.300591 | Val Loss: 0.384855 | LR: 0.0000500
2025-06-08 07:47:19,021 - root - INFO -   验证损失未改善 8轮。
2025-06-08 07:47:56,145 - root - INFO - Epoch [14/50] | Train Loss: 0.295214 | Val Loss: 0.416337 | LR: 0.0000500
2025-06-08 07:47:56,146 - root - INFO -   验证损失未改善 9轮。
2025-06-08 07:48:32,755 - root - INFO - Epoch [15/50] | Train Loss: 0.291942 | Val Loss: 0.418719 | LR: 0.0000500
2025-06-08 07:48:32,755 - root - INFO -   验证损失未改善 10轮。
2025-06-08 07:49:11,903 - root - INFO - Epoch [16/50] | Train Loss: 0.283597 | Val Loss: 0.409677 | LR: 0.0000500
2025-06-08 07:49:11,903 - root - INFO -   验证损失未改善 11轮。
2025-06-08 07:49:49,289 - root - INFO - Epoch [17/50] | Train Loss: 0.280699 | Val Loss: 0.497650 | LR: 0.0000500
2025-06-08 07:49:49,289 - root - INFO -   验证损失未改善 12轮。
2025-06-08 07:50:25,390 - root - INFO - Epoch [18/50] | Train Loss: 0.278819 | Val Loss: 0.487982 | LR: 0.0000500
2025-06-08 07:50:25,391 - root - INFO -   验证损失未改善 13轮。
2025-06-08 07:51:01,643 - root - INFO - Epoch [19/50] | Train Loss: 0.277785 | Val Loss: 0.460215 | LR: 0.0000500
2025-06-08 07:51:01,644 - root - INFO -   学习率从 0.0000500 降低到 0.0000050
2025-06-08 07:51:01,645 - root - INFO -   验证损失未改善 14轮。
2025-06-08 07:51:38,012 - root - INFO - Epoch [20/50] | Train Loss: 0.272386 | Val Loss: 0.486908 | LR: 0.0000050
2025-06-08 07:51:38,012 - root - INFO -   验证损失未改善 15轮。
2025-06-08 07:51:38,012 - root - INFO - 触发早停！在 15 轮内验证损失未改善。
2025-06-08 07:51:38,013 - root - INFO - 已加载早停（或最终epoch）得到的最佳模型权重。
2025-06-08 07:51:38,015 - root - INFO - TimeSeriesDataset内部的输入缩放器已保存到: models/pytorch_input_scaler_v19_segmentation.pkl
2025-06-08 07:51:38,017 - root - INFO - 目标缩放器已保存到: models/pytorch_target_scaler_v19_segmentation.pkl
2025-06-08 07:51:38,025 - root - INFO - RMSSE scales 已保存到: models/rmsse_scales_v19_segmentation.json
2025-06-08 07:51:38,030 - root - INFO - WRMSSE weights 已保存到: models/wrmsse_weights_v19_segmentation.json
2025-06-08 07:51:38,031 - root - INFO - 模型训练流程完成。
2025-06-08 07:51:38,367 - root - INFO - Phase 3: 模型训练成功。
2025-06-08 07:51:38,368 - root - INFO - ===== Phase 4: 模型评估 (回归) =====
2025-06-08 07:51:38,369 - root - INFO - 接收到 41798 行用于评估。
2025-06-08 07:51:38,369 - root - INFO - 开始回归模型评估 (包含标准RMSSE/WRMSSE)...
2025-06-08 07:51:38,370 - root - INFO - DEBUG_EVAL: Config object received in evaluate_regression_model: <class 'dict'>
2025-06-08 07:51:38,370 - root - INFO - DEBUG_EVAL: eval_conf from config.get('evaluation_regression', {}): {'metrics': ['mean_squared_error', 'mean_absolute_error', 'r2_score', 'wmape', 'smape', 'rmsse', 'wrmsse'], 'rmsse_base_sales_col': 'sales_W', 'wrmsse_weight_column': 'sales_W', 'wrmsse_weight_period_weeks': 4}
2025-06-08 07:51:38,371 - root - INFO - DEBUG_EVAL: metrics_to_calculate list to be used: ['mean_squared_error', 'mean_absolute_error', 'r2_score', 'wmape', 'smape', 'rmsse', 'wrmsse']
2025-06-08 07:51:38,371 - root - INFO - DEBUG_EVAL: Type of metrics_to_calculate: <class 'list'>
2025-06-08 07:51:38,372 - root - INFO - DEBUG_EVAL: First element of metrics_to_calculate: 'mean_squared_error', type: <class 'str'>
2025-06-08 07:51:38,374 - root - INFO - PCA未启用 (评估)，使用 93 个数值特征。
2025-06-08 07:51:38,386 - root - INFO - 使用预训练的输入数值特征缩放器 (transform)...
2025-06-08 07:51:38,447 - root - INFO - 使用预训练的目标列缩放器 (transform)...
2025-06-08 07:51:45,028 - root - INFO - 成功创建 8840 个时间序列样本。
2025-06-08 07:51:45,029 - root - INFO - 测试 DataLoader 创建完成，包含 8840 个样本。
2025-06-08 07:51:45,801 - root - INFO - DEBUG_EVAL: original_scale_predictions shape: (8840, 6)
2025-06-08 07:51:45,801 - root - INFO - DEBUG_EVAL: original_scale_true_targets shape: (8840, 6)
2025-06-08 07:51:45,865 - root - INFO - 指标 (缩放尺度) for sales_W_lead1: {'mse': 0.0569697730243206, 'mae': 0.12248394638299942, 'r2': 0.9026933908462524, 'wmape': 31.02845549583435, 'smape': 47.82071013275037}
2025-06-08 07:51:46,884 - root - INFO - 指标 (原始尺度) for sales_W_lead1: {'mse': 155.4995574951172, 'mae': 6.399138450622559, 'r2': 0.9026933908462524, 'wmape': 28.58302593231201, 'smape': 39.11557766971037, 'rmsse': 0.8351577203125262}
2025-06-08 07:51:46,886 - root - INFO - 指标 (缩放尺度) for sales_W_lead2: {'mse': 0.10704588145017624, 'mae': 0.15758419036865234, 'r2': 0.7661514282226562, 'wmape': 40.746280550956726, 'smape': 55.08616983601006}
2025-06-08 07:51:47,905 - root - INFO - 指标 (原始尺度) for sales_W_lead2: {'mse': 291.28070068359375, 'mae': 8.220221519470215, 'r2': 0.7661514282226562, 'wmape': 43.899449706077576, 'smape': 53.19436225943529, 'rmsse': 1.004103502831795}
2025-06-08 07:51:47,907 - root - INFO - 指标 (缩放尺度) for sales_W_growth_4w_1p_lead1: {'mse': 0.27161911129951477, 'mae': 0.33682453632354736, 'r2': 0.35735344886779785, 'wmape': 77.38052606582642, 'smape': 111.74641887355882}
2025-06-08 07:51:48,928 - root - INFO - 指标 (原始尺度) for sales_W_growth_4w_1p_lead1: {'mse': 0.020616577938199043, 'mae': 0.09279656410217285, 'r2': 0.3573535084724426, 'wmape': 78.34849953651428, 'smape': 116.23979444543062, 'rmsse': 0.022226653534947485}
2025-06-08 07:51:48,930 - root - INFO - 指标 (缩放尺度) for sales_W_growth_4w_1p_lead2: {'mse': 0.3401212990283966, 'mae': 0.4375939667224884, 'r2': 0.2898845076560974, 'wmape': 81.61791563034058, 'smape': 118.49424281371643}
2025-06-08 07:51:49,954 - root - INFO - 指标 (原始尺度) for sales_W_growth_4w_1p_lead2: {'mse': 0.019939830526709557, 'mae': 0.10595344752073288, 'r2': 0.2898845672607422, 'wmape': 84.29780602455139, 'smape': 125.27316946962934, 'rmsse': 0.023822811398440506}
2025-06-08 07:51:49,956 - root - INFO - 指标 (缩放尺度) for smoothed_sales_W_growth_4w_1p_lead1: {'mse': 0.2022002935409546, 'mae': 0.31464633345603943, 'r2': 0.5681382417678833, 'wmape': 63.180869817733765, 'smape': 94.97364146739203}
2025-06-08 07:51:50,995 - root - INFO - 指标 (原始尺度) for smoothed_sales_W_growth_4w_1p_lead1: {'mse': 0.0028127192053943872, 'mae': 0.0371103435754776, 'r2': 0.5681382417678833, 'wmape': 63.38176727294922, 'smape': 96.30714704248308, 'rmsse': 0.008701648499160325}
2025-06-08 07:51:50,997 - root - INFO - 指标 (缩放尺度) for smoothed_sales_W_growth_4w_1p_lead2: {'mse': 0.3772309124469757, 'mae': 0.4658529460430145, 'r2': 0.34591686725616455, 'wmape': 80.27368783950806, 'smape': 116.91460160497367}
2025-06-08 07:51:52,030 - root - INFO - 指标 (原始尺度) for smoothed_sales_W_growth_4w_1p_lead2: {'mse': 0.00420877430588007, 'mae': 0.049206558614969254, 'r2': 0.3459168076515198, 'wmape': 81.48134350776672, 'smape': 119.41973284635148, 'rmsse': 0.01068824857244528}
2025-06-08 07:51:52,030 - root - INFO - 总体平均目标RMSSE (各目标RMSSE的均值): 0.3175
2025-06-08 07:51:52,031 - root - INFO - DEBUG_EVAL: Sales related targets for WRMSSE: ['sales_W_lead1', 'sales_W_lead2']
2025-06-08 07:51:52,752 - root - INFO - 总体 WRMSSE (基于 'sales_W' 相关目标): 1.0925
2025-06-08 07:51:52,753 - root - INFO - 模型评估完成。
2025-06-08 07:51:52,787 - root - INFO - Phase 4 整体评估结果字典: {'sales_W_lead1_scaled_metrics': {'mse': 0.0569697730243206, 'mae': 0.12248394638299942, 'r2': 0.9026933908462524, 'wmape': 31.02845549583435, 'smape': 47.82071013275037}, 'sales_W_lead1_original_metrics': {'mse': 155.4995574951172, 'mae': 6.399138450622559, 'r2': 0.9026933908462524, 'wmape': 28.58302593231201, 'smape': 39.11557766971037, 'rmsse': 0.8351577203125262}, 'sales_W_lead2_scaled_metrics': {'mse': 0.10704588145017624, 'mae': 0.15758419036865234, 'r2': 0.7661514282226562, 'wmape': 40.746280550956726, 'smape': 55.08616983601006}, 'sales_W_lead2_original_metrics': {'mse': 291.28070068359375, 'mae': 8.220221519470215, 'r2': 0.7661514282226562, 'wmape': 43.899449706077576, 'smape': 53.19436225943529, 'rmsse': 1.004103502831795}, 'sales_W_growth_4w_1p_lead1_scaled_metrics': {'mse': 0.27161911129951477, 'mae': 0.33682453632354736, 'r2': 0.35735344886779785, 'wmape': 77.38052606582642, 'smape': 111.74641887355882}, 'sales_W_growth_4w_1p_lead1_original_metrics': {'mse': 0.020616577938199043, 'mae': 0.09279656410217285, 'r2': 0.3573535084724426, 'wmape': 78.34849953651428, 'smape': 116.23979444543062, 'rmsse': 0.022226653534947485}, 'sales_W_growth_4w_1p_lead2_scaled_metrics': {'mse': 0.3401212990283966, 'mae': 0.4375939667224884, 'r2': 0.2898845076560974, 'wmape': 81.61791563034058, 'smape': 118.49424281371643}, 'sales_W_growth_4w_1p_lead2_original_metrics': {'mse': 0.019939830526709557, 'mae': 0.10595344752073288, 'r2': 0.2898845672607422, 'wmape': 84.29780602455139, 'smape': 125.27316946962934, 'rmsse': 0.023822811398440506}, 'smoothed_sales_W_growth_4w_1p_lead1_scaled_metrics': {'mse': 0.2022002935409546, 'mae': 0.31464633345603943, 'r2': 0.5681382417678833, 'wmape': 63.180869817733765, 'smape': 94.97364146739203}, 'smoothed_sales_W_growth_4w_1p_lead1_original_metrics': {'mse': 0.0028127192053943872, 'mae': 0.0371103435754776, 'r2': 0.5681382417678833, 'wmape': 63.38176727294922, 'smape': 96.30714704248308, 'rmsse': 0.008701648499160325}, 'smoothed_sales_W_growth_4w_1p_lead2_scaled_metrics': {'mse': 0.3772309124469757, 'mae': 0.4658529460430145, 'r2': 0.34591686725616455, 'wmape': 80.27368783950806, 'smape': 116.91460160497367}, 'smoothed_sales_W_growth_4w_1p_lead2_original_metrics': {'mse': 0.00420877430588007, 'mae': 0.049206558614969254, 'r2': 0.3459168076515198, 'wmape': 81.48134350776672, 'smape': 119.41973284635148, 'rmsse': 0.01068824857244528}, 'overall_mean_rmsse_per_target': 0.3174500975248858, 'overall_wrmsse': 1.0924782444260521}
2025-06-08 07:51:52,789 - root - INFO - 评估结果已保存到: results/pytorch_regression_evaluation_v19_segmentation.json
2025-06-08 07:51:52,789 - root - INFO - ===== Phase 5: 预测与趋势解释 =====
2025-06-08 07:51:52,790 - root - INFO - 接收到 41798 行数据用于预测和解释。
2025-06-08 07:51:52,803 - root - INFO - 使用预训练的输入数值特征缩放器 (transform)...
2025-06-08 07:51:52,863 - root - WARNING - 目标列缩放器未提供且fit_scalers=False。目标将保持原始尺度。
2025-06-08 07:51:59,295 - root - INFO - 成功创建 8840 个时间序列样本。
2025-06-08 07:51:59,719 - root - INFO - Phase 5: 成功生成原始尺度的预测值，形状: (8840, 6)
2025-06-08 07:51:59,726 - root - INFO - 使用原始测试集的末尾ID和日期合并。
2025-06-08 07:51:59,726 - root - INFO - 开始解释产品趋势...
2025-06-08 07:51:59,728 - root - INFO - 为 lead1 应用 3 条趋势解释规则...
2025-06-08 07:51:59,741 - root - INFO - 已为 interpreted_trend_lead1 生成趋势标签。
2025-06-08 07:51:59,742 - root - INFO - 为 lead2 应用 2 条趋势解释规则...
2025-06-08 07:51:59,746 - root - INFO - 已为 interpreted_trend_lead2 生成趋势标签。
2025-06-08 07:51:59,746 - root - INFO - 产品趋势解释完成。
2025-06-08 07:51:59,775 - root - INFO - 解释性预测结果已保存到: results/pytorch_regression_predictions_v19_segmentation.parquet
2025-06-08 07:51:59,797 - root - INFO - ===== Phase 6: 生成HTML报告 =====
2025-06-08 07:51:59,820 - root - INFO - Phase 6: HTML报告已成功生成并保存到: results/dashboard_report.html
2025-06-08 07:51:59,821 - root - INFO - 流程运行完毕。
